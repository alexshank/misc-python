## 09-02-2025 - Learn Cantrill (Cross-Account S3, AWS RAM, Service Quota, Identities and Federation, Networking)

- S3 ACLs use a Canonical Account ID
- may want to setup S3 buckets so that owner owns all uploaded objects
- AWS RAM potentially changes how you'd architect things
	- originally, accounts were isolated and then connected via transit gateways or VPC peers
- Availability Zone IDs actually stay consistent between accounts
	- AWS rotates which physical facilities serve us-east-1a, for example
	- AZ ID would be "use1-az1"
- need to accept resource share invite
	- unless your AWS Org is setup to automatically accept shares
- "Shared Services VPC" is a class AWS RAM pattern
	- particpants still own their resources
	- particants have read-only visibility of owner's networking resource
- Naming of resources can be per-account for AWS RAM shared resources
- AWS services typically have a per-region service quota
	- some service are per-account
- starting quotas are relatively low for professional work and architectures
- some services have hard limits
	- they can impact architecture choices
	- e.g., 5000 IAM Users per account
- Quota Request Templates can be used across your AWS Org
- can create CW Alarms for when nearing service limits
- there are multiple ways to interact with service quotas
	- exam questions are typically based around all these different methods
- SAML 2.0 Identity Federation
	- you can only ever interact with AWS resources using AWS credentials
		- you just gain these AWS credentials through Identity Federation
	- main selection criteria for this is
		- Enterprise Identity Provider
		- SAML 2.0 compatible
	- you would NOT use SAML 2.0 Identity Federation for Google logins!!!
	- SAML 2.0 typically used by large organizations, and especially those with a Windows-based IdP
- IAM Identity Center (Successor to AWS Single Sign-On (SSO))
	- AWS SSO is almost always preferred over direct SAML 2.0 Identity Federation
	- requires AWS Organization to be configured
	- "enterprise" or "workplace" identities => AWS SSO
	- "web" or "user" identities => AWS Cognito
- Amazon Cognito
	- naming in this service is very poor
	- provided authn, authz, and user management
    - User Pools are for signing in, signing up, and obtaining JWT tokens 
		- JWTs can't be used by most AWS services	
	- Identity Pools allow you to offer access to temporary AWS credentials
		- this is for either unauthenticated or authenticated identities
		- social logins or SAML 2.0 identities can be swapped for temporary creds
		- a User Pool login could be swapped for temporary creds
	- login with social would happen within User Pools but outside of Identity Pools
		- can then combine this architecture to avoid dealing with many different types of external auth tokens
		- this architecture is called "web identity federation" (WEBIDF)
	- "federation" is the process of swapping external identity tokens for AWS credentials
- Public vs Private AWS Services 
	- there are three different network zones to consider
		- public internet zone
		- AWS Public zone
		- AWS Private zone
- Dynamic Host Configuration Protocol (DHCP)
- DHCP Option Sets are immutable and can be attached to zero or more VPCs
- DHCP is how a device gets an IP, subnet mask, and default gateway
	- these are all automatically generated by AWS in each AWS VPC
- in AWS VPC, your DHCP Option Set can only control the DNS server to use
	- R53 Resolver by default
		- private and (potential) public DNS hostnames are generated automatically
	- could configure your own DNS server
	- could also configure NTP servers
- VPC Routers are always at the "subnet+1" address
- VPC Routers are controlled using route tables
- every subnet has a VPC Router Interface
- subnets are associated with ONE ROUTE TABLE
	- there's a default Main Route Table (RT) for the entire VPC
	- main RT should be left completely blank for security posture reasons
		- it gets automatically associated with subnets if the subnet's custom RT is removed
	- the route tables network prefix number determine the specificity of the route
		- e.g., "10.16.0.0/16"
- ephemeral port rangers are a big downside of stateless firewalls
